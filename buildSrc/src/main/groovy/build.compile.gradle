plugins {
  id 'fs'
  id 'org.jetbrains.kotlin.jvm'
}

project.afterEvaluate {

  fs.info("${project.name}: import build.compile")

  //sourceSets {
  //  main.kotlin.srcDirs += ['src/main/kotlin', 'src/main/java']
  //  main.java.srcDirs += ['src/main/kotlin', 'src/main/java']
  //  test.kotlin.srcDirs += ['src/test/kotlin', 'src/test/java']
  //  test.java.srcDirs += ['src/test/kotlin', 'src/test/java']
  //}

  compileJava {
    options.encoding = 'UTF-8'
    //options.compilerArgs += ['-Werror', '-Xlint']
    options.incremental = false
  }
  compileTestJava {
    options.encoding = 'UTF-8'
  }

  compileKotlin {
    kotlinOptions {
      jvmTarget = javaVersion
      freeCompilerArgs = ['-Xjvm-default=all']
    }
  }
  compileTestKotlin {
    kotlinOptions {
      jvmTarget = javaVersion
      freeCompilerArgs = ['-Xjvm-default=all']
    }
  }
}

tasks.withType(JavaCompile) {
  options.incremental = false
}