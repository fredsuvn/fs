<?xml version="1.0" encoding="UTF-8"?>
<?asciidoc-toc maxdepth="3"?>
<?asciidoc-numbered?>
<article xmlns="http://docbook.org/ns/docbook" xmlns:xl="http://www.w3.org/1999/xlink" version="5.0" xml:lang="en">
<info>
<title><inlinemediaobject>
<imageobject>
<imagedata fileref="../../logo.svg"/>
</imageobject>
<textobject><phrase>Boat Serialize</phrase></textobject>
</inlinemediaobject> <literal>boat-serialize</literal></title>
<subtitle>Boat Serialize&#8201;&#8212;&#8201;Serialize and Deserialize Lib of <link xl:href="../../README.md">Boat</link></subtitle>
<date>2021-07-05</date>
<author>
<personname>
<firstname>Sun</firstname>
<surname>Qian</surname>
</personname>
<email>fredsuvn@163.com</email>
</author>
<authorinitials>SQ</authorinitials>
</info>
<section xml:id="_introduction">
<title>Introduction</title>
<simpara>Boat Serialize provides Unified interfaces (<literal>Serializer</literal>, <literal>Serial</literal>) to support serialize and deserialize operations.</simpara>
<simpara>Now format it supports are:</simpara>
<itemizedlist>
<listitem>
<simpara><xref linkend="_json"/></simpara>
</listitem>
</itemizedlist>
</section>
<section xml:id="_usage">
<title>Usage</title>
<section xml:id="_json">
<title>JSON</title>
<simpara>Json package provides JSON format implementation of <literal>Serial</literal>: <literal>Json</literal>.</simpara>
<simpara>To get a <literal>Json</literal>, we can use core utilities of boat-serialize: <literal>JsonSerials</literal>.</simpara>
<formalpara>
<title>Java Examples</title>
<para>
<programlisting language="java" linenumbering="unnumbered">class Example{
    @Test
    public void test() {
        Json json = JsonSerials.toJson("{\"p1\":\"p1 value\",\"p2\":\"p2 value\"}");
        Map&lt;String, String&gt; map = json.toObject(new TypeRef&lt;Map&lt;String, String&gt;&gt;() {
        });
    }
}</programlisting>
</para>
</formalpara>
<formalpara>
<title>Kotlin Examples</title>
<para>
<programlisting language="kotlin" linenumbering="unnumbered">class Example {
    @Test
    fun test() {
        val json = "{\"p1\":\"p1 value\",\"p2\":\"p2 value\"}".toJson()
        val map: Map&lt;String, String&gt; = json.toObject(object : TypeRef&lt;Map&lt;String, String&gt;&gt;() {})
    }
}</programlisting>
</para>
</formalpara>
<simpara><literal>JsonSerials</literal> uses default <literal>JsonSerializer</literal>&#8201;&#8212;&#8201;the core interface for <literal>Serializer</literal> with <literal>JSON</literal>, to implement its methods.
We can also use <literal>JsonSerializer</literal> directly:</simpara>
<formalpara>
<title>Java Examples</title>
<para>
<programlisting language="java" linenumbering="unnumbered">class Example{
    @Test
    public void test() {
        JsonSerializer serializer = JsonSerializer.DEFAULT;
        String mapJson = "{\"p1\":\"p1 value\",\"p2\":\"p2 value\"}";
        Map&lt;String, String&gt; map = serializer.toJson(mapJson).toObject(new TypeRef&lt;Map&lt;String, String&gt;&gt;() {
        });
    }
}</programlisting>
</para>
</formalpara>
<formalpara>
<title>Kotlin Examples</title>
<para>
<programlisting language="kotlin" linenumbering="unnumbered">class Example {
    @Test
    fun test() {
        val serializer = JsonSerializer.DEFAULT
        val mapJson = "{\"p1\":\"p1 value\",\"p2\":\"p2 value\"}"
        val map: Map&lt;String, String&gt; =
            serializer.toJson(mapJson).toObject(object : TypeRef&lt;Map&lt;String, String&gt;&gt;() {})
    }
}</programlisting>
</para>
</formalpara>
<simpara>Default <literal>JsonSerializer</literal> implementation is come from <literal>Jacksons.DEFAULT_OBJECT_MAPPER</literal> which is an <literal>ObjectMapper</literal> of <literal>jackson</literal>.
We can also create a custom <literal>JsonSerializer</literal> with another <literal>oObjectMapper</literal>:</simpara>
<formalpara>
<title>Java Examples</title>
<para>
<programlisting language="java" linenumbering="unnumbered">class Example{
    @Test
    public void test() {
        JsonSerializer serializer = Jacksons.newJsonSerializer(Jacksons.DEFAULT_OBJECT_MAPPER);
    }
}</programlisting>
</para>
</formalpara>
<formalpara>
<title>Kotlin Examples</title>
<para>
<programlisting language="kotlin" linenumbering="unnumbered">class Example {
    @Test
    fun test() {
        val serializer: JsonSerializer = DEFAULT_OBJECT_MAPPER.toJsonSerializer()
    }
}</programlisting>
</para>
</formalpara>
</section>
</section>
<section xml:id="_samples">
<title>Samples</title>
<formalpara>
<title>Java Examples</title>
<para>
<programlisting language="java" linenumbering="unnumbered">package sample.java.xyz.srclab.serialize;

import org.testng.annotations.Test;
import xyz.srclab.common.reflect.TypeRef;
import xyz.srclab.common.serialize.json.Jacksons;
import xyz.srclab.common.serialize.json.Json;
import xyz.srclab.common.serialize.json.JsonSerializer;
import xyz.srclab.common.serialize.json.JsonSerials;
import xyz.srclab.common.test.TestLogger;

import java.util.Map;

public class SerializeSample {

    private static final TestLogger logger = TestLogger.DEFAULT;

    @Test
    public void testJsonSerials() {
        Json json = JsonSerials.toJson("{\"p1\":\"p1 value\",\"p2\":\"p2 value\"}");
        Map&lt;String, String&gt; map = json.toObject(new TypeRef&lt;Map&lt;String, String&gt;&gt;() {
        });
        //{p1=p1 value, p2=p2 value}
        logger.log(map);

        String stringJson = "abc";
        //"abc"
        logger.log("stringJson: {}", JsonSerials.stringify(stringJson));
    }

    @Test
    public void testJsonSerializer() {
        JsonSerializer serializer = JsonSerializer.DEFAULT;
        String mapJson = "{\"p1\":\"p1 value\",\"p2\":\"p2 value\"}";
        Map&lt;String, String&gt; map = serializer.toJson(mapJson).toObject(new TypeRef&lt;Map&lt;String, String&gt;&gt;() {
        });
        //{p1=p1 value, p2=p2 value}
        logger.log(map);

        String stringJson = "abc";
        //"abc"
        logger.log("stringJson: {}", serializer.serialize(stringJson));
    }

    @Test
    public void testJackson() {
        JsonSerializer serializer = Jacksons.newJsonSerializer(Jacksons.DEFAULT_OBJECT_MAPPER);
        String mapJson = "{\"p1\":\"p1 value\",\"p2\":\"p2 value\"}";
        Map&lt;String, String&gt; map = serializer.toJson(mapJson).toObject(new TypeRef&lt;Map&lt;String, String&gt;&gt;() {
        });
        //{p1=p1 value, p2=p2 value}
        logger.log(map);

        String stringJson = "abc";
        //"abc"
        logger.log("stringJson: {}", serializer.serialize(stringJson));
    }
}</programlisting>
</para>
</formalpara>
<formalpara>
<title>Kotlin Examples</title>
<para>
<programlisting language="kotlin" linenumbering="unnumbered">package sample.kotlin.xyz.srclab.serialize

import org.testng.annotations.Test
import xyz.srclab.common.reflect.TypeRef
import xyz.srclab.common.serialize.json.*
import xyz.srclab.common.test.TestLogger

class SerializeSample {

    private val logger = TestLogger.DEFAULT

    @Test
    fun testJsonSerials() {
        val json = "{\"p1\":\"p1 value\",\"p2\":\"p2 value\"}".toJson()
        val map: Map&lt;String, String&gt; = json.toObject(object : TypeRef&lt;Map&lt;String, String&gt;&gt;() {})
        //{p1=p1 value, p2=p2 value}
        logger.log(map)
        val stringJson = "abc"
        //"abc"
        logger.log("stringJson: {}", stringJson.stringify())
    }

    @Test
    fun testJsonSerializer() {
        val serializer = JsonSerializer.DEFAULT
        val mapJson = "{\"p1\":\"p1 value\",\"p2\":\"p2 value\"}"
        val map: Map&lt;String, String&gt; =
            serializer.toJson(mapJson).toObject(object : TypeRef&lt;Map&lt;String, String&gt;&gt;() {})
        //{p1=p1 value, p2=p2 value}
        logger.log(map)
        val stringJson = "abc"
        //"abc"
        logger.log("stringJson: {}", serializer.serialize(stringJson))
    }

    @Test
    fun testJackson() {
        val serializer: JsonSerializer = DEFAULT_OBJECT_MAPPER.toJsonSerializer()
        val mapJson = "{\"p1\":\"p1 value\",\"p2\":\"p2 value\"}"
        val map: Map&lt;String, String&gt; =
            serializer.toJson(mapJson).toObject(object : TypeRef&lt;Map&lt;String, String&gt;&gt;() {})
        //{p1=p1 value, p2=p2 value}
        logger.log(map)
        val stringJson = "abc"
        //"abc"
        logger.log("stringJson: {}", serializer.serialize(stringJson))
    }
}</programlisting>
</para>
</formalpara>
</section>
</article>